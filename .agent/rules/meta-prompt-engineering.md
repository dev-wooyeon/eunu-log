# Meta Prompt: 견고한 AI 보조 엔지니어링 운영 규칙

## 사용 목적
이 문서는 기능 구현보다 **품질 게이트**를 우선 적용하기 위한 운영 프롬프트다.
변경의 안정성, 재현성, 회귀 방지를 강제한다.

## 시스템 분석 요약 (현재 저장소 기준)
- 강점:
  - 토큰 기반 디자인 시스템(`src/styles/tokens.css`)으로 전역 일관성 확보가 쉬움
  - `husky + lint-staged`가 이미 있어 로컬 가드레일 확장이 쉬움
  - `build/test/lint` 명령이 분리되어 품질 게이트 구성이 명확함
- 리스크:
  - App Router + client/animation 혼합 구조라 작은 스타일/상호작용 변경도 영향 범위가 넓음
  - 다크모드/토큰 변경이 전역 UI에 파급될 가능성 큼
  - 로컬 중심 검증(현재 CI 부재)이라 작업자 습관에 따라 품질 편차가 생김

## 실행 프롬프트 (에이전트가 매 작업 시작 시 적용)
아래 규칙을 항상 따른다.

1. 입력 정제
- 사용자 요구를 한 줄의 완료 조건으로 재정의한다.
- 범위 밖 변경은 하지 않는다.

2. 위험도 분류
- `LOW`: 텍스트/문서/스타일 미세 조정
- `MEDIUM`: 토큰/공용 컴포넌트/페이지 로직 수정
- `HIGH`: 빌드 설정, 라우팅, 데이터 로딩, 렌더링 경계(client/server) 변경
- `MEDIUM` 이상은 변경 전 영향 파일과 검증 계획을 먼저 명시한다.

3. 최소 변경 원칙
- 요구사항 충족에 필요한 파일만 수정한다.
- 하드코딩보다 토큰/공용 유틸 재사용을 우선한다.

4. 품질 게이트
- 기본: `npm run build`
- 코드 변경 시: `npm run lint` 추가
- 로직/유틸 변경 시: `npm test` 또는 대상 테스트 실행
- 실패 시 원인/재현 방법/우회 여부를 함께 보고한다.

5. Git 규율
- 브랜치: `codex/<task>`
- 커밋: `<type>: <한국어 설명>`
- 한 커밋은 하나의 의도만 담는다.
- 원격 푸시 후 이력 변경이 필요하면 이유와 리스크를 먼저 설명한다.

6. 리뷰 모드 강제
- 항상 "회귀 가능성" 관점으로 셀프리뷰한다.
- 최소 3가지 확인:
  - 영향 범위가 의도와 일치하는가
  - 다크/라이트, 모바일/데스크톱 중 깨지는 케이스가 없는가
  - 규칙 위반(`any`, 임의 Tailwind 값, 애니메이션 위치)이 없는가

7. 보고 포맷 고정
- `변경 요약`
- `검증 결과`
- `리스크/남은 작업`
- 길게 설명하지 말고 의사결정에 필요한 사실만 적는다.

## 작업 중단/질문 트리거
- 기존에 보지 못한 대규모 변경이 워킹트리에 나타난 경우 즉시 중단 후 확인한다.
- 요구사항과 충돌하는 기존 규칙이 발견되면 우선순위를 질문한다.
- 고위험(HIGH) 변경이 필요하지만 검증 수단이 없으면 진행하지 않고 대안을 제시한다.

## PR 품질 체크리스트
- 제목이 결과 중심의 쉬운 한국어인가
- 본문이 `변경 내용 / 의도 / 검증` 구조를 따르는가
- UI 변경 시 스코프(전역/특정 페이지)가 명확한가
- 후속 작업이 TODO로 분리되어 있는가

## 권장 운영 확장
- 향후 CI 도입 시 동일 게이트(`lint`, `test`, `build`)를 PR 필수 체크로 강제한다.
- 디자인 토큰 변경 PR에는 스냅샷(또는 주요 페이지 캡처) 첨부를 기본화한다.
